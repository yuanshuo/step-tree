<!DOCTYPE html>
<html>

<head>
    <title>奥力给</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="UTF-8">
    <link rel="stylesheet" href="https://7npmedia.w3cschool.cn/w3.css">
    <script src="http://cdn.staticfile.org/moment.js/2.24.0/moment.min.js"></script>
    <script>
        function numberSum(str) {
            let res = Number(str);
            if (!Number.isNaN(res)) {
                return res;
            }
            if (Number.isNaN(res) && str.indexOf('+')>-1) {
                let arr = str.split('+');
                let sum = Number(0);
                arr.forEach(val=>{
                    sum += Number(val.trim());
                });
                return sum;
            }
            return NaN;
        }
        function test() {
            let gongsi = document.getElementsByName('reportType')[0].checked;
            let jituan = document.getElementsByName('reportType')[1].checked;
            if (!gongsi && !jituan) {
                document.getElementById('id01').style.display='block'
                return;
            }

            let old = document.getElementById('old').value;
            let month = old.substring(old.indexOf('月度'), old.indexOf('年度'));
            let year = old.substring(old.indexOf('年度'));

            let laidianReg = /来电(\d+)[组，]+/;
            let laifangReg = /，[来访客户]*(\d+)[组，]+/;
            let ziranReg = /自然来访(\d+)[组，]+/;
            let ziquReg = /，自渠来访(\d+)[组，]+/;
            let zhongjieReg = /，中介来访(\d+)[组，]+/;
            let qudaoReg = /，渠道来访(\d+)[组，]+/;
            let zaifangReg = /，再访(\d+)[组，]+/;
            let rengouReg = /认购(\d+)[套，]+/;
            let rengouJineReg = /金额([\d\.]+)[万元，]+/;
            let hetongReg = /合同(\d+)[套|，]/;
            let hetongJineReg = /合同金额([\d\.]+)[万元，]+/;
            let huikuanReg = /回款([\d\.]+)[万元，]+/;


            // 当日
            let laidian = Number(document.getElementById('laidian').value);
            let laifang = Number(document.getElementById('laifang').value);
            let xinfang = Number(document.getElementById('xinfang').value);
            let ziran = Number(document.getElementById('ziran').value);
            let ziqu = Number(document.getElementById('ziqu').value);
            let zhongjie = Number(document.getElementById('zhongjie').value);
            let qudao = ziqu + zhongjie;
            let zaifang = Number(document.getElementById('zaifang').value);
            let yezhu = Number(document.getElementById('yezhu').value);
            let canguan = Number(document.getElementById('canguan').value);
            let heyuan = Number(document.getElementById('heyuan').value);
            let dieshu = Number(document.getElementById('dieshu').value);
            let yangfang = Number(document.getElementById('yangfang').value);
            let qita = Number(document.getElementById('qita').value);
            let rengou = Number(document.getElementById('rengou').value);
            let rengoujine = numberSum(document.getElementById('rengoujine').value);
            let hetong = Number(document.getElementById('hetong').value);
            let hetongjine = numberSum(document.getElementById('hetongjine').value);
            let huikuan = numberSum(document.getElementById('huikuan').value);

            // 月度
            console.log('月度');

            console.log('laidian');
            month.match(laidianReg);
            let mlaidianReg = Number(RegExp.$1)
            console.log(mlaidianReg);
            mlaidianReg += (laidian);
            console.log(mlaidianReg);

            console.log('laifang');
            month.match(laifangReg);
            let mlaifangReg = Number(RegExp.$1)
            console.log(mlaifangReg);
            mlaifangReg += laifang;
            console.log(mlaifangReg);

            console.log('ziran');
            month.match(ziranReg);
            let mziranReg = Number(RegExp.$1)
            console.log(mziranReg);
            mziranReg += (ziran);
            console.log(mziranReg);

            console.log('ziqu');
            month.match(ziquReg);
            let mziquReg = Number(RegExp.$1)
            console.log(mziquReg);
            mziquReg += (ziqu);
            console.log(mziquReg);

            console.log('zhongjie');
            month.match(zhongjieReg);
            let mzhongjieReg = Number(RegExp.$1)
            console.log(mzhongjieReg);
            mzhongjieReg += (zhongjie);
            console.log(mzhongjieReg);

            console.log('qudao');
            month.match(qudaoReg);
            let mqudaoReg = Number(RegExp.$1)
            console.log(mqudaoReg);
            mqudaoReg += (zhongjie + ziqu);
            console.log(mqudaoReg);

            console.log('zaifang');
            month.match(zaifangReg);
            let mzaifangReg = Number(RegExp.$1)
            console.log(mzaifangReg);
            mzaifangReg += (zaifang);
            console.log(mzaifangReg);

            console.log('rengou');
            month.match(rengouReg);
            let mrengouReg = Number(RegExp.$1)
            console.log(mrengouReg);
            mrengouReg+= (rengou);
            console.log(mrengouReg);

            console.log('rengoujine');
            month.match(rengouJineReg);
            let mrengouJineReg = Number(RegExp.$1)
            console.log(mrengouJineReg);
            mrengouJineReg += (rengoujine);
            console.log(mrengouJineReg);

            console.log('hetong');
            month.match(hetongReg);
            let mhetongReg = Number(RegExp.$1)
            console.log(mhetongReg);
            mhetongReg+= hetong;
            console.log(mhetongReg);

            console.log('hetongjine');
            month.match(hetongJineReg);
            let mhetongJineReg = Number(RegExp.$1)
            console.log(mhetongJineReg);
            mhetongJineReg += (hetongjine);
            console.log(mhetongJineReg);

            console.log('huikuan');
            month.match(huikuanReg);
            let mhuikuanReg = Number(RegExp.$1)
            console.log(mhuikuanReg);
            mhuikuanReg += (huikuan);
            console.log(mhuikuanReg);


            // 年度
            console.log('年度');

            console.log('laidian');
            year.match(laidianReg);
            let ylaidianReg = Number(RegExp.$1)
            console.log(ylaidianReg);
            ylaidianReg += (laidian);
            console.log(ylaidianReg);

            console.log('laifang');
            year.match(laifangReg);
            let ylaifangReg = Number(RegExp.$1)
            console.log(ylaifangReg);
            ylaifangReg += (laifang);
            console.log(ylaifangReg);

            console.log('hetong');
            year.match(hetongReg);
            let yhetongReg = Number(RegExp.$1)
            console.log(yhetongReg);
            yhetongReg += (hetong);
            console.log(yhetongReg);

            console.log('hetongjine');
            year.match(hetongJineReg);
            let yhetongJineReg = Number(RegExp.$1)
            console.log(yhetongJineReg);
            yhetongJineReg += (hetongjine);
            console.log(yhetongJineReg);

            console.log('huikuan');
            year.match(huikuanReg);
            let yhuikuanReg = Number(RegExp.$1)
            console.log(yhuikuanReg);
            yhuikuanReg += (huikuan);
            console.log(yhuikuanReg);


            // 公司日报
            if(gongsi) {
                let content = '【' + moment().format("MM月DD日") + '销售日报】\n' +
                    '【当日】来电' + laidian + '组，来访' + laifang + '组，其中新访' + xinfang + '组（自然来访' + ziran + '组，自渠来访' + ziqu + '组，中介来访' + zhongjie + '组），再访' + zaifang + '组，业主' + yezhu + '组，参观' + canguan + '组。\n' +
                    '当日来访客户中意向，合院' + heyuan + '组，叠墅' + dieshu + '组，洋房' + yangfang + '组，其他' + qita + '组。\n' +
                    '当日认购' + rengou + '套，金额' + rengoujine.toFixed(4) + '万；\n' +
                    '当日合同' + hetong + '套，合同金额' + hetongjine.toFixed(4) + '万元；\n' +
                    '当日回款' + huikuan.toFixed(4) + '万元。\n' +
                    '【月度】\n' +
                    '来电' + mlaidianReg + '组，来访' + mlaifangReg + '组（自然来访' + mziranReg + '组，自渠来访' + mziquReg + '组，中介来访' + mzhongjieReg + '组，再访' + mzaifangReg + '组）\n' +
                    '认购' + mrengouReg + '套，金额' + mrengouJineReg.toFixed(4) + '万；\n' +
                    '合同' + mhetongReg + '套，合同金额' + mhetongJineReg.toFixed(4) + '万元；\n' +
                    '回款' + mhuikuanReg.toFixed(4) + '万元。\n' +
                    '【年度】\n' +
                    '来电' + ylaidianReg + '组，来访客户' + ylaifangReg + '组。\n' +
                    '合同' + yhetongReg + '套，合同金额' + yhetongJineReg.toFixed(4) + '万元，回款' + yhuikuanReg.toFixed(4) + '万元。';

                document.getElementById('new').value = content;
                return;
            }


            // 集团日报
            if(jituan) {
                let content2 = '【' + moment().format("MM月DD日") + '销售日报】\n' +
                    '【当日】来电' + laidian + '组，来访' + laifang + '组，其中新访' + xinfang + '组（自然来访' + ziran + '组，渠道来访' + qudao + '组），再访' + zaifang + '组，业主' + yezhu + '组，参观' + canguan + '组。\n' +
                    '当日认购' + rengou + '套，金额' + rengoujine.toFixed(4) + '万；\n' +
                    '当日合同' + hetong + '套，合同金额' + hetongjine.toFixed(4) + '万元；\n' +
                    '当日回款' + huikuan.toFixed(4) + '万元。\n' +
                    '【月度】\n' +
                    '来电' + mlaifangReg + '组，来访' + mlaifangReg + '组（自然来访' + mziranReg + '组，渠道来访' + mqudaoReg + '组，再访' + mzaifangReg + '组）\n' +
                    '认购' + mrengouReg + '套，金额' + mrengouJineReg.toFixed(4) + '万；\n' +
                    '合同' + mhetongReg + '套，合同金额' + mhetongJineReg.toFixed(4) + '万元；\n' +
                    '回款' + mhuikuanReg.toFixed(4) + '万元。\n' +
                    '【年度】\n' +
                    '来电' + ylaidianReg + '组，来访客户' + ylaifangReg + '组。\n' +
                    '合同' + yhetongReg + '套，合同金额' + yhetongJineReg.toFixed(4) + '万元，回款' + yhuikuanReg.toFixed(4) + '万元。';

                document.getElementById('new').value = content2;
            }

        }
    </script>
</head>

<body>
<div class="w3-container w3-black">
    <h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">请开始你的工作汇报</font></font></h2>
</div>

<div class="w3-container w3-light-grey w3-text-brown">
    <form class="w3-container">
        <input class="w3-radio" type="radio" name="reportType" value="1">
        <label>公司汇报</label>
        <input class="w3-radio" type="radio" name="reportType" value="2">
        <label>集团汇报</label>

        <p></p>

        <label>昨日汇报内容：</label>
        <textarea class="w3-input" rows="10" id="old" placeholder="长按粘贴"></textarea>

        <p></p>
        <label class="w3-red">当日来电(组)：</label>
        <input class="w3-input" type="text" id="laidian"/>

        <label class="w3-red">当日来访(组)：</label>
        <input class="w3-input" type="text" id="laifang"/>

        <label>新访：</label>
        <input class="w3-input" type="text" id="xinfang"/>

        <label>自然来访：</label>
        <input class="w3-input" type="text" id="ziran"/>

        <label>[渠道]自渠来访：</label>
        <input class="w3-input" type="text" id="ziqu"/>

        <label>[渠道]中介来访：</label>
        <input class="w3-input" type="text" id="zhongjie"/>

        <label>再访：</label>
        <input class="w3-input" type="text" id="zaifang"/>

        <label>业主：</label>
        <input class="w3-input" type="text" id="yezhu"/>

        <label>参观：</label>
        <input class="w3-input" type="text" id="canguan"/>

        <label>意向合院：</label>
        <input class="w3-input" type="text" id="heyuan"/>

        <label>意向叠墅：</label>
        <input class="w3-input" type="text" id="dieshu"/>

        <label>意向洋房：</label>
        <input class="w3-input" type="text" id="yangfang"/>

        <label>意向其他：</label>
        <input class="w3-input" type="text" id="qita"/>

        <label class="w3-red">当日认购(套)：</label>
        <input class="w3-input" type="text" id="rengou"/>

        <label>认购金额(万)：</label>
        <input class="w3-input" type="text" id="rengoujine" placeholder="支持+运算"/>

        <label class="w3-red">当日合同(套)：</label>
        <input class="w3-input" type="text" id="hetong"/>

        <label>合同金额(万)：</label>
        <input class="w3-input" type="text" id="hetongjine" placeholder="支持+运算"/>

        <label class="w3-red">当日回款(万)：</label>
        <input class="w3-input" type="text" id="huikuan" placeholder="支持+运算"/>

        <button class="w3-button w3-black" type="button" onclick="test()">点我生成汇报内容</button>
        <p></p>
        <label>今日汇报内容：</label>
        <textarea class="w3-input" rows="10" id="new" placeholder="长按全选复制"></textarea>

        <div id="id01" class="w3-modal">
            <div class="w3-modal-content">
                <div class="w3-container">
                    <span onclick="document.getElementById('id01').style.display='none'" class="w3-button w3-display-topright">&times;</span>
                    <p class="w3-large">❌️先选个汇报类型吧！</p>
                </div>
            </div>
        </div>
    </form>
</div>


<div class="w3-container w3-dark-grey">
    <p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小马哥版权所有©2022-v4</font></font></p>
</div>

</body>
</html>